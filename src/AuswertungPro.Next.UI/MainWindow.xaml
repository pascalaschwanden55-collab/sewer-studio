<Window x:Class="AuswertungPro.Next.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Name="RootWindow"
        Title="{Binding Title}" Width="1200" Height="750" MinWidth="1000" MinHeight="650"
        WindowStartupLocation="CenterScreen"
        Closing="MainWindow_Closing">
    <Window.InputBindings>
        <KeyBinding Key="F11" Command="{Binding ToggleFocusModeCommand}"/>
    </Window.InputBindings>
    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <Menu.Style>
                <Style TargetType="Menu">
                    <Setter Property="Visibility" Value="Visible"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsFocusMode}" Value="True">
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Menu.Style>
            <MenuItem Header="_Datei">
                <MenuItem Header="Neues Projekt" Command="{Binding NewProjectCommand}"/>
                <MenuItem Header="Projekt öffnen..." Command="{Binding OpenProjectCommand}"/>
                <MenuItem Header="Speichern" Command="{Binding SaveCommand}"/>
                <MenuItem Header="Speichern unter..." Command="{Binding SaveAsProjectCommand}"/>
                <Separator/>
                <MenuItem Header="Beenden" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Werkzeuge">
                <MenuItem Header="Code-Katalog..." Click="OpenCodeCatalog_Click"/>
                <Separator/>
                <MenuItem Header="KI Videoanalyse – Training Center..." Click="OpenTrainingCenter_Click"/>
            </MenuItem>
            <MenuItem Header="_Ansicht">
                <MenuItem Header="Fokusmodus (F11)" IsCheckable="True" IsChecked="{Binding IsFocusMode, Mode=TwoWay}" />
            </MenuItem>

        </Menu>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition>
                <ColumnDefinition.Style>
                    <Style TargetType="ColumnDefinition">
                        <Setter Property="Width" Value="240"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding DataContext.IsFocusMode, ElementName=RootWindow}" Value="True">
                                <Setter Property="Width" Value="0"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ColumnDefinition.Style>
            </ColumnDefinition>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Left navigation — Cyberpunk sidebar -->
        <Border Grid.Column="0" Background="{StaticResource NavPanelBrush}" BorderThickness="0,0,1,0">
            <Border.Style>
                <Style TargetType="Border">
                    <Setter Property="Visibility" Value="Visible"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding DataContext.IsFocusMode, ElementName=RootWindow}" Value="True">
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
            <Border.BorderBrush>
                <SolidColorBrush Color="{StaticResource ColorNeonCyan}" Opacity="0.25"/>
            </Border.BorderBrush>
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Margin="16,18,16,12">
                    <!-- Neon glowing app title -->
                    <TextBlock Text="⬡ SEWER·STUDIO" FontSize="17" FontWeight="Bold" Foreground="{StaticResource NeonCyanBrush}" FontFamily="Consolas, Segoe UI">
                        <TextBlock.Effect>
                            <DropShadowEffect Color="{StaticResource ColorNeonCyan}" BlurRadius="12" ShadowDepth="0" Opacity="0.5"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    <TextBlock Text="{Binding Subtitle}" Margin="0,4,0,0" Foreground="{StaticResource MutedBrush}" FontSize="11" FontFamily="Consolas"/>
                    <!-- Neon divider line -->
                    <Border Height="1" Margin="0,10,0,0" Background="{StaticResource NeonGradient}" Opacity="0.4"/>
                </StackPanel>

                <ListBox ItemsSource="{Binding NavItems}" SelectedItem="{Binding SelectedNavItem}"
                         BorderThickness="0" Background="Transparent" Margin="8,0,8,8">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border CornerRadius="10" Padding="12,10">
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <Grid Width="28" Height="20" VerticalAlignment="Center">
                                        <TextBlock x:Name="DefaultNavIcon"
                                                   Text="{Binding Icon}"
                                                   FontFamily="Segoe MDL2 Assets"
                                                   FontSize="18"
                                                   Width="28"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"/>

                                        <!-- Kanalisationsrohr fuer Haltungen -->
                                        <Canvas x:Name="PipeNavIcon" Width="28" Height="20" Visibility="Collapsed">
                                            <Ellipse Canvas.Left="1.5" Canvas.Top="4" Width="7.5" Height="12"
                                                     Stroke="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"
                                                     StrokeThickness="1.6"/>
                                            <Line X1="5.5" Y1="4" X2="22.5" Y2="4"
                                                  Stroke="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"
                                                  StrokeThickness="1.6"/>
                                            <Line X1="5.5" Y1="16" X2="22.5" Y2="16"
                                                  Stroke="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"
                                                  StrokeThickness="1.6"/>
                                            <Ellipse Canvas.Left="19" Canvas.Top="4" Width="7.5" Height="12"
                                                     Stroke="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"
                                                     StrokeThickness="1.6"/>
                                        </Canvas>

                                        <!-- Kanalisationsschacht fuer Schaechte -->
                                        <Canvas x:Name="ShaftNavIcon" Width="28" Height="20" Visibility="Collapsed">
                                            <Ellipse Canvas.Left="6" Canvas.Top="2" Width="16" Height="4.5"
                                                     Stroke="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"
                                                     StrokeThickness="1.6"/>
                                            <Rectangle Canvas.Left="8" Canvas.Top="4.5" Width="12" Height="10.5"
                                                       Stroke="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"
                                                       StrokeThickness="1.6"/>
                                            <Ellipse Canvas.Left="8" Canvas.Top="13" Width="12" Height="4.5"
                                                     Stroke="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"
                                                     StrokeThickness="1.6"/>
                                            <Line X1="2" Y1="10" X2="8" Y2="10"
                                                  Stroke="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"
                                                  StrokeThickness="1.6"/>
                                            <Line X1="20" Y1="10" X2="26" Y2="10"
                                                  Stroke="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"
                                                  StrokeThickness="1.6"/>
                                        </Canvas>

                                        <!-- VSA-Icon im gleichen Line-Art Stil -->
                                        <Canvas x:Name="VsaNavIcon" Width="28" Height="20" Visibility="Collapsed">
                                            <Ellipse Canvas.Left="1" Canvas.Top="10.5" Width="7" Height="7"
                                                     Fill="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"/>
                                            <Ellipse Canvas.Left="2.5" Canvas.Top="4.5" Width="5.5" Height="5.5"
                                                     Fill="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"/>
                                            <Ellipse Canvas.Left="6.5" Canvas.Top="1.5" Width="4.5" Height="4.5"
                                                     Fill="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"/>
                                            <Ellipse Canvas.Left="11.5" Canvas.Top="0.5" Width="3.8" Height="3.8"
                                                     Fill="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"/>
                                            <Ellipse Canvas.Left="16.5" Canvas.Top="2.3" Width="3.2" Height="3.2"
                                                     Fill="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"/>
                                            <Ellipse Canvas.Left="20.5" Canvas.Top="6" Width="2.8" Height="2.8"
                                                     Fill="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"/>
                                            <Ellipse Canvas.Left="22.8" Canvas.Top="10.8" Width="2.2" Height="2.2"
                                                     Fill="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"/>
                                            <TextBlock Canvas.Left="12.5" Canvas.Top="12.5"
                                                       Text="V"
                                                       FontSize="7"
                                                       FontWeight="SemiBold"
                                                       Foreground="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}"/>
                                        </Canvas>
                                    </Grid>
                                    <TextBlock Text="{Binding Title}" Margin="8,0,0,0" FontSize="15"/>
                                </StackPanel>
                            </Border>
                            <DataTemplate.Triggers>
                                <DataTrigger Binding="{Binding Title}" Value="Haltungen">
                                    <Setter TargetName="DefaultNavIcon" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="PipeNavIcon" Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Title}" Value="Schaechte">
                                    <Setter TargetName="DefaultNavIcon" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="ShaftNavIcon" Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Title}" Value="VSA">
                                    <Setter TargetName="DefaultNavIcon" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="VsaNavIcon" Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </DataTemplate.Triggers>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem">
                            <Setter Property="Margin" Value="0,2"/>
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                            <Setter Property="IsEnabled" Value="True"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="ListBoxItem">
                                        <Border x:Name="bd" Background="{TemplateBinding Background}" CornerRadius="10" Padding="2"
                                                BorderThickness="1" BorderBrush="Transparent">
                                            <ContentPresenter/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter TargetName="bd" Property="Background" Value="#200099AA"/>
                                                <Setter TargetName="bd" Property="BorderBrush" Value="{StaticResource NeonCyanBrush}"/>
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="bd" Property="Background" Value="#100099AA"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding DataContext.IsProjectReady, RelativeSource={RelativeSource AncestorType=ListBox}}" Value="False">
                                    <Setter Property="IsEnabled" Value="False"/>
                                    <Setter Property="Opacity" Value="0.5"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Title}" Value="Uebersicht">
                                    <Setter Property="IsEnabled" Value="True"/>
                                    <Setter Property="Opacity" Value="1"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Title}" Value="Projekt">
                                    <Setter Property="IsEnabled" Value="True"/>
                                    <Setter Property="Opacity" Value="1"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ListBox.ItemContainerStyle>
                </ListBox>

                <!-- Buttons entfernt, werden in ProjectPage platziert -->
            </DockPanel>
        </Border>

        <!-- Content -->
        <Grid Grid.Column="1" Margin="18">
            <Grid.Style>
                <Style TargetType="Grid">
                    <Setter Property="Margin" Value="18"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding DataContext.IsFocusMode, ElementName=RootWindow}" Value="True">
                            <Setter Property="Margin" Value="8"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>
            <Border Style="{StaticResource Card}">
                <Grid>
                    <ContentControl Content="{Binding CurrentPage}"/>
                    <Border Background="#CCF0F2F8" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="12">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsProjectReady}" Value="False">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding SelectedNavItem.Title}" Value="Projekt">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding SelectedNavItem.Title}" Value="Uebersicht">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" MaxWidth="420">
                            <TextBlock Text="Bitte zuerst ein Projekt speichern (Datei anlegen)." FontSize="16"
                                       FontWeight="SemiBold" Foreground="{StaticResource TextBrush}" TextAlignment="Center"/>
                            <TextBlock Text="Danach sind alle Funktionen freigeschaltet." Margin="0,6,0,0"
                                       Foreground="{StaticResource MutedBrush}" TextAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>
        </Grid>

    </Grid>
    </DockPanel>
</Window>

